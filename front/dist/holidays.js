(function(){var BankHolidaysAdmin,BankHolidaysDirective,debounce,initBankHolidaysPlugin,module;debounce=function(wait,func){return _.debounce(func,wait,{leading:!0,trailing:!1})},BankHolidaysAdmin=function(){function BankHolidaysAdmin(rootScope,scope,repo,appMetaService,confirm,http){this.rootScope=rootScope,this.scope=scope,this.repo=repo,this.appMetaService=appMetaService,this.confirm=confirm,this.http=http,this.scope.sectionName="Bank holidays",this.scope.sectionSlug="bank holidays",this.scope.$on("project:loaded",function(_this){return function(){var promise;return promise=_this.repo.queryMany("holidays",{project:_this.scope.projectId}),promise.then(function(bank_holidays){return _this.scope.holidays={project:_this.scope.projectId,is_ignoring_weekends:!1,is_ignoring_days:!1,days_ignored:[]},bank_holidays.length>0?_this.scope.holidays=bank_holidays[0]:void 0})}}(this))}return BankHolidaysAdmin.$inject=["$rootScope","$scope","$tgRepo","tgAppMetaService","$tgConfirm","$tgHttp"],BankHolidaysAdmin}(),BankHolidaysDirective=function($repo,$confirm,$loading){var link;return link=function($scope,$el,$attrs){var form,submit,submitButton;return form=$el.find("form").checksley({onlyOneErrorElement:!0}),submit=debounce(2e3,function(_this){return function(event){var currentLoading,promise;return event.preventDefault(),form.validate()?(currentLoading=$loading().target(submitButton).start(),$scope.holidays.id?(promise=$repo.save($scope.holidays),promise.then(function(data){return $scope.holidays=data})):(promise=$repo.create("holidays",$scope.holidays),promise.then(function(data){return $scope.holidays=data})),promise.then(function(data){return currentLoading.finish(),$confirm.notify("success")}),promise.then(null,function(data){return currentLoading.finish(),form.setErrors(data),data._error_message?$confirm.notify("error",data._error_message):void 0})):void 0}}(this)),submitButton=$el.find(".submit-button"),$el.on("submit","form",submit),$el.on("click",".submit-button",submit)},{link:link}},module=angular.module("taigaContrib.bankholidays",[]),module.controller("ContribBankHolidaysAdminController",BankHolidaysAdmin),module.directive("contribBankHolidays",["$tgRepo","$tgConfirm","$tgLoading",BankHolidaysDirective]),initBankHolidaysPlugin=function($tgUrls){return $tgUrls.update({holidays:"/holidays"})},module.run(["$tgUrls",initBankHolidaysPlugin])}).call(this),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("/plugins/holidays/holidays.html",'\n<div contrib-bank-holidays="contrib-bank-holidays" ng-controller="ContribBankHolidaysAdminController as ctrl">\n  <header>\n    <h1><span class="project-name">{{::project.name}}</span><span class="green">{{::sectionName}}</span></h1>\n  </header>\n  <form>\n    <fieldset>\n      <div class="check-item"><span>Ignore weekends</span>\n        <div class="check">\n          <input type="checkbox" name="ignore_weekends" ng-model="holidays.is_ignoring_weekends"/>\n          <div></div><span translate="COMMON.YES" class="check-text check-yes"></span><span translate="COMMON.NO" class="check-text check-no"></span>\n        </div>\n      </div>\n    </fieldset>\n    <!--/fieldset\n    h2 Ignore specific days\n    div.check-item\n        span Ignore selected days\n        div.check\n            input(type="checkbox" name="ignore_days" ng-model="holidays.is_ignoring_days")\n            div\n            span.check-text.check-yes(translate="COMMON.YES")\n            span.check-text.check-no(translate="COMMON.NO")\n    \n    // Date picker\n    \n    \n    -->\n    <button type="submit" title="{{\'COMMON.SAVE\' | translate}}" translate="COMMON.SAVE" class="button-green submit-button"></button>\n    <tg-svg svg-icon="icon-question"></tg-svg><span>Do you need help? Check out our support page!</span>\n  </form>\n</div>')}]);